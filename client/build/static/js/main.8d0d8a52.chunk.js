(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{259:function(e,t,n){e.exports=n(452)},289:function(e,t,n){},452:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(56),l=n.n(o),s=n(20),i=n.n(s),c=n(23),u=n(8),p=n(11),h=n(9),m=n(4),f=n(10),d=n(27),b=n(81),O=n.n(b),v=Object(a.createContext)({}),y=v.Consumer,E=v.Provider,g=E,j=function(e){var t=function(t,n){return r.a.createElement(y,null,function(a){return r.a.createElement(e,Object.assign({},t,{leaflet:a,ref:n}))})},n=e.displayName||e.name;t.displayName="Leaflet(".concat(n,")");var o=Object(a.forwardRef)(t);return O()(o,e),o},k=n(13),w=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).leafletElement=n.createLeafletElement(n.props),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){throw new Error("createLeafletElement() must be implemented")}},{key:"updateLeafletElement",value:function(e,t){t.position!==e.position&&this.leafletElement.setPosition(t.position)}},{key:"componentDidMount",value:function(){this.leafletElement.addTo(this.props.leaflet.map)}},{key:"componentDidUpdate",value:function(e){this.updateLeafletElement(e,this.props)}},{key:"componentWillUnmount",value:function(){this.leafletElement.remove()}},{key:"render",value:function(){return null}}]),t}(a.Component),L=(j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Control.Attribution(e)}}]),t}(w)),n(33)),C=n(21),S=n(24),x=n(28),T=/^on(.+)$/i,P=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e)))._leafletEvents=n.extractLeafletEvents(e),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.bindLeafletEvents(this._leafletEvents)}},{key:"componentDidUpdate",value:function(e){this._leafletEvents=this.bindLeafletEvents(this.extractLeafletEvents(this.props),this._leafletEvents)}},{key:"componentWillUnmount",value:function(){var e=this.leafletElement;e&&Object(x.forEach)(this._leafletEvents,function(t,n){e.off(n,t)})}},{key:"extractLeafletEvents",value:function(e){return Object.keys(e).reduce(function(t,n){T.test(n)&&(null!=e[n]&&(t[n.replace(T,function(e,t){return t.toLowerCase()})]=e[n]));return t},{})}},{key:"bindLeafletEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.leafletElement;if(null==n||null==n.on)return{};var a=Object(C.a)({},t);return Object(x.forEach)(t,function(t,r){null!=e[r]&&t===e[r]||(delete a[r],n.off(r,t))}),Object(x.forEach)(e,function(e,r){null!=t[r]&&e===t[r]||(a[r]=e,n.on(r,e))}),a}},{key:"fireLeafletEvent",value:function(e,t){var n=this.leafletElement;n&&n.fire(e,t)}}]),t}(a.Component),M=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"getOptions",value:function(e){return null!=e.pane?e:null!=e.leaflet&&null!=e.leaflet.pane?Object(C.a)({},e,{pane:e.leaflet.pane}):e}}]),t}(P),H=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).leafletElement=n.createLeafletElement(e),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){throw new Error("createLeafletElement() must be implemented")}},{key:"updateLeafletElement",value:function(e,t){}},{key:"componentDidMount",value:function(){Object(S.a)(Object(m.a)(t.prototype),"componentDidMount",this).call(this),this.layerContainer.addLayer(this.leafletElement)}},{key:"componentDidUpdate",value:function(e){if(Object(S.a)(Object(m.a)(t.prototype),"componentDidUpdate",this).call(this,e),this.props.attribution!==e.attribution){var n=this.props.leaflet.map;null!=n&&null!=n.attributionControl&&(n.attributionControl.removeAttribution(e.attribution),n.attributionControl.addAttribution(this.props.attribution))}this.updateLeafletElement(e,this.props)}},{key:"componentWillUnmount",value:function(){Object(S.a)(Object(m.a)(t.prototype),"componentWillUnmount",this).call(this),this.layerContainer.removeLayer(this.leafletElement)}},{key:"render",value:function(){console.log("MapLayer: render");var e=this.props.children;return null==e?null:null==this.contextValue?r.a.createElement(a.Fragment,null,e):r.a.createElement(g,{value:this.contextValue},e)}},{key:"layerContainer",get:function(){return this.props.leaflet.layerContainer||this.props.leaflet.map}}]),t}(M),I=["stroke","color","weight","opacity","lineCap","lineJoin","dashArray","dashOffset","fill","fillColor","fillOpacity","fillRule","bubblingMouseEvents","renderer","className","interactive","pane","attribution"],_=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).leafletElement=n.createLeafletElement(e),null==n.contextValue&&(n.contextValue=Object(C.a)({},e.leaflet,{popupContainer:n.leafletElement})),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){Object(S.a)(Object(m.a)(t.prototype),"componentDidUpdate",this).call(this,e),this.setStyleIfChanged(e,this.props)}},{key:"getPathOptions",value:function(e){return Object(x.pick)(e,I)}},{key:"setStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.leafletElement.setStyle(e)}},{key:"setStyleIfChanged",value:function(e,t){var n=this.getPathOptions(t);Object(x.isEqual)(n,this.getPathOptions(e))||this.setStyle(n)}}]),t}(H),U=(j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=e.center,n=e.radius,a=Object(L.a)(e,["center","radius"]);return new k.Circle(t,n,this.getOptions(a))}},{key:"updateLeafletElement",value:function(e,t){t.center!==e.center&&this.leafletElement.setLatLng(t.center),t.radius!==e.radius&&this.leafletElement.setRadius(t.radius)}}]),t}(_)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=new k.CircleMarker(e.center,this.getOptions(e));return this.contextValue=Object(C.a)({},e.leaflet,{popupContainer:t}),t}},{key:"updateLeafletElement",value:function(e,t){t.center!==e.center&&this.leafletElement.setLatLng(t.center),t.radius!==e.radius&&this.leafletElement.setRadius(t.radius)}}]),t}(_)),function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(" ").filter(Boolean)}),D=function(e,t){U(t).forEach(function(t){k.DomUtil.addClass(e,t)})},V=function(e,t){U(t).forEach(function(t){k.DomUtil.removeClass(e,t)})},W=function(e,t,n){null!=e&&n!==t&&(null!=t&&t.length>0&&V(e,t),null!=n&&n.length>0&&D(e,n))},R=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).onClose=function(){n.props.onClose&&n.props.onClose()},n.onOpen=function(){n.forceUpdate(),n.props.onOpen&&n.props.onOpen()},n.leafletElement=n.createLeafletElement(e),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){throw new Error("createLeafletElement() must be implemented")}},{key:"updateLeafletElement",value:function(e,t){}},{key:"componentDidUpdate",value:function(e){W(this.leafletElement._container,e.className,this.props.className),this.updateLeafletElement(e,this.props),this.leafletElement.isOpen()&&(this.leafletElement.update(),this.onRender())}},{key:"onRender",value:function(){}},{key:"render",value:function(){return this.leafletElement._contentNode?Object(o.createPortal)(this.props.children,this.leafletElement._contentNode):null}}]),t}(M);j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=new k.FeatureGroup(this.getOptions(e));return this.contextValue=Object(C.a)({},e.leaflet,{layerContainer:t,popupContainer:t}),t}},{key:"componentDidMount",value:function(){Object(S.a)(Object(m.a)(t.prototype),"componentDidMount",this).call(this),this.setStyle(this.props)}}]),t}(_));console.log("GeoJSON class component");j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return console.log("GeoJSON createLeafletElement, props.data",e.data),console.log("GeoJSON createLeafletElement, this.getOptions(props)",this.getOptions(e)),new k.GeoJSON(e.data,this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,t){console.log("GeoJSON updateLeafletElement fromProps",e),console.log("GeoJSON updateLeafletElement toProps",t),"function"===typeof t.style?this.setStyle(t.style):this.setStyleIfChanged(e,t)}}]),t}(_));var A=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.GridLayer(this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,t){var n=t.opacity,a=t.zIndex;n!==e.opacity&&this.leafletElement.setOpacity(n),a!==e.zIndex&&this.leafletElement.setZIndex(a)}},{key:"getOptions",value:function(e){var n=Object(S.a)(Object(m.a)(t.prototype),"getOptions",this).call(this,e);return null==e.leaflet.map?n:Object(C.a)({maxZoom:e.leaflet.map.options.maxZoom,minZoom:e.leaflet.map.options.minZoom},n)}},{key:"render",value:function(){return null}}]),t}(H),F=(j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=new k.ImageOverlay(e.url,e.bounds,this.getOptions(e));return this.contextValue=Object(C.a)({},e.leaflet,{popupContainer:t}),t}},{key:"updateLeafletElement",value:function(e,t){t.url!==e.url&&this.leafletElement.setUrl(t.url),t.bounds!==e.bounds&&this.leafletElement.setBounds(Object(k.latLngBounds)(t.bounds)),t.opacity!==e.opacity&&this.leafletElement.setOpacity(t.opacity),t.zIndex!==e.zIndex&&this.leafletElement.setZIndex(t.zIndex)}}]),t}(H)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=new k.LayerGroup(this.getOptions(e));return this.contextValue=Object(C.a)({},e.leaflet,{layerContainer:t}),t}}]),t}(H)),n(26)),N=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.checked;null!=this.props.leaflet.map&&(!0!==this.props.checked||null!=t&&!1!==t?!0!==t||null!=this.props.checked&&!1!==this.props.checked||this.props.leaflet.map.removeLayer(this.layer):this.props.leaflet.map.addLayer(this.layer))}},{key:"componentWillUnmount",value:function(){this.props.removeLayerControl(this.layer)}},{key:"addLayer",value:function(){throw new Error("Must be implemented in extending class")}},{key:"removeLayer",value:function(e){this.props.removeLayer(e)}},{key:"render",value:function(){var e=this.props.children;return e?r.a.createElement(g,{value:this.contextValue},e):null}}]),t}(a.Component),z=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).addLayer=function(e){n.layer=e;var t=n.props,a=t.addBaseLayer,r=t.checked;a(e,t.name,r)},n.contextValue=Object(C.a)({},e.leaflet,{layerContainer:{addLayer:n.addLayer.bind(Object(F.a)(Object(F.a)(n))),removeLayer:n.removeLayer.bind(Object(F.a)(Object(F.a)(n)))}}),n}return Object(f.a)(t,e),t}(N),B=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).addLayer=function(e){n.layer=e;var t=n.props,a=t.addOverlay,r=t.checked;a(e,t.name,r)},n.contextValue=Object(C.a)({},e.leaflet,{layerContainer:{addLayer:n.addLayer.bind(Object(F.a)(Object(F.a)(n))),removeLayer:n.removeLayer.bind(Object(F.a)(Object(F.a)(n)))}}),n}return Object(f.a)(t,e),t}(N),Z=j(function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).controlProps={addBaseLayer:n.addBaseLayer.bind(Object(F.a)(Object(F.a)(n))),addOverlay:n.addOverlay.bind(Object(F.a)(Object(F.a)(n))),leaflet:e.leaflet,removeLayer:n.removeLayer.bind(Object(F.a)(Object(F.a)(n))),removeLayerControl:n.removeLayerControl.bind(Object(F.a)(Object(F.a)(n)))},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){e.children;var t=Object(L.a)(e,["children"]);return new k.Control.Layers(void 0,void 0,t)}},{key:"updateLeafletElement",value:function(e,n){Object(S.a)(Object(m.a)(t.prototype),"updateLeafletElement",this).call(this,e,n),n.collapsed!==e.collapsed&&(!0===n.collapsed?this.leafletElement.collapse():this.leafletElement.expand())}},{key:"componentWillUnmount",value:function(){var e=this;setTimeout(function(){Object(S.a)(Object(m.a)(t.prototype),"componentWillUnmount",e).call(e)},0)}},{key:"addBaseLayer",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&null!=this.props.leaflet.map&&this.props.leaflet.map.addLayer(e),this.leafletElement.addBaseLayer(e,t)}},{key:"addOverlay",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&null!=this.props.leaflet.map&&this.props.leaflet.map.addLayer(e),this.leafletElement.addOverlay(e,t)}},{key:"removeLayer",value:function(e){null!=this.props.leaflet.map&&this.props.leaflet.map.removeLayer(e)}},{key:"removeLayerControl",value:function(e){this.leafletElement.removeLayer(e)}},{key:"render",value:function(){var e=this,t=a.Children.map(this.props.children,function(t){return t?Object(a.cloneElement)(t,e.controlProps):null});return r.a.createElement(a.Fragment,null,t)}}]),t}(w));Z.BaseLayer=z,Z.Overlay=B;var G=Z,J=n(204),K=["children","className","id","style","useFlyTo","whenReady"],q=function(e){return Array.isArray(e)?[e[0],e[1]]:[e.lat,e.lon?e.lon:e.lng]},Q=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).viewport={center:void 0,zoom:void 0},n._updating=!1,n.onViewportChange=function(){var e=n.leafletElement.getCenter();n.viewport={center:e?[e.lat,e.lng]:void 0,zoom:n.leafletElement.getZoom()},n.props.onViewportChange&&!n._updating&&n.props.onViewportChange(n.viewport)},n.onViewportChanged=function(){n.props.onViewportChanged&&!n._updating&&n.props.onViewportChanged(n.viewport)},n.bindContainer=function(e){n.container=e},console.log("props:",e),n.className=e.className,n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=e.viewport,n=Object(L.a)(e,["viewport"]);return t&&(t.center&&(n.center=t.center),"number"===typeof t.zoom&&(n.zoom=t.zoom)),new k.Map(this.container,n)}},{key:"updateLeafletElement",value:function(e,t){this._updating=!0;var n=t.animate,a=t.bounds,r=t.boundsOptions,o=t.boxZoom,l=t.center,s=t.className,i=t.doubleClickZoom,c=t.dragging,u=t.keyboard,p=t.maxBounds,h=t.scrollWheelZoom,m=t.tap,f=t.touchZoom,d=t.useFlyTo,b=t.viewport,O=t.zoom;if(W(this.container,e.className,s),b&&b!==e.viewport){var v=b.center?b.center:l,y=null==b.zoom?O:b.zoom;!0===d?this.leafletElement.flyTo(v,y,{animate:n}):this.leafletElement.setView(v,y,{animate:n})}else l&&this.shouldUpdateCenter(l,e.center)?!0===d?this.leafletElement.flyTo(l,O,{animate:n}):this.leafletElement.setView(l,O,{animate:n}):"number"===typeof O&&O!==e.zoom&&(null==e.zoom?this.leafletElement.setView(l,O):this.leafletElement.setZoom(O));p&&this.shouldUpdateBounds(p,e.maxBounds)&&this.leafletElement.setMaxBounds(p),a&&(this.shouldUpdateBounds(a,e.bounds)||r!==e.boundsOptions)&&(!0===d?this.leafletElement.flyToBounds(a,r):this.leafletElement.fitBounds(a,r)),o!==e.boxZoom&&(!0===o?this.leafletElement.boxZoom.enable():this.leafletElement.boxZoom.disable()),i!==e.doubleClickZoom&&(!0===i?this.leafletElement.doubleClickZoom.enable():this.leafletElement.doubleClickZoom.disable()),c!==e.dragging&&(!0===c?this.leafletElement.dragging.enable():this.leafletElement.dragging.disable()),u!==e.keyboard&&(!0===u?this.leafletElement.keyboard.enable():this.leafletElement.keyboard.disable()),h!==e.scrollWheelZoom&&(!0===h||"string"===typeof h?(this.leafletElement.options.scrollWheelZoom=h,this.leafletElement.scrollWheelZoom.enable()):this.leafletElement.scrollWheelZoom.disable()),m!==e.tap&&(!0===m?this.leafletElement.tap.enable():this.leafletElement.tap.disable()),f!==e.touchZoom&&(!0===f||"string"===typeof f?(this.leafletElement.options.touchZoom=f,this.leafletElement.touchZoom.enable()):this.leafletElement.touchZoom.disable()),this._updating=!1}},{key:"componentDidMount",value:function(){var e=Object(x.omit)(this.props,K);this.leafletElement=this.createLeafletElement(e),this.leafletElement.on("move",this.onViewportChange),this.leafletElement.on("moveend",this.onViewportChanged),null!=e.bounds&&this.leafletElement.fitBounds(e.bounds,e.boundsOptions),this.props.whenReady&&this.leafletElement.whenReady(this.props.whenReady),this.contextValue={layerContainer:this.leafletElement,map:this.leafletElement};var n={placeholder:"Etsi...",errorMessage:"Ei kohteita.",showResultIcons:!0,position:"topleft",geocoder:new J.L.Control.Geocoder.Nominatim({geocodingQueryParams:{"accept-language":"fi"}})};new J.L.Control.Geocoder(n).addTo(this.contextValue.map),this.contextValue.map.on("click",function(t){e.handleMapClick([t.latlng.lng,t.latlng.lat]),console.log("props2",e)});var a={radius:8,fillColor:"darkorange",color:"black",weight:1,opacity:1,fillOpacity:.8};this.hotspotLayer=Object(k.geoJSON)([],{pointToLayer:function(e,t){return Object(k.circleMarker)(t,a)}}).addTo(this.contextValue.map),this.hotspotLayer.addData(e.hotspots),this.hotspotLayer.bringToFront(),this.hotspotLayer.on("click",function(t){k.DomEvent.stopPropagation(t),e.handleHotspotClick(t)}),Object(S.a)(Object(m.a)(t.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"componentDidUpdate",value:function(e){console.log("updated?: ",this.props.hotspots),this.hotspotLayer.clearLayers(),this.hotspotLayer.addData(this.props.hotspots),this.updateLeafletElement(e,this.props)}},{key:"componentWillUnmount",value:function(){Object(S.a)(Object(m.a)(t.prototype),"componentWillUnmount",this).call(this),this.leafletElement.off("move",this.onViewportChange),this.leafletElement.off("moveend",this.onViewportChanged),!0===this.props.preferCanvas?(this.leafletElement._initEvents(!0),this.leafletElement._stop()):this.leafletElement.remove()}},{key:"shouldUpdateCenter",value:function(e,t){return!t||(e=q(e),t=q(t),e[0]!==t[0]||e[1]!==t[1])}},{key:"shouldUpdateBounds",value:function(e,t){return!t||!Object(k.latLngBounds)(e).equals(Object(k.latLngBounds)(t))}},{key:"render",value:function(){return r.a.createElement("div",{className:this.className,id:this.props.id,ref:this.bindContainer,style:this.props.style},this.contextValue?r.a.createElement(g,{value:this.contextValue},this.props.children):null)}}]),t}(P),Y=j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=new k.Marker(e.position,this.getOptions(e));return this.contextValue=Object(C.a)({},e.leaflet,{popupContainer:t}),t}},{key:"updateLeafletElement",value:function(e,t){t.position!==e.position&&this.leafletElement.setLatLng(t.position),t.icon!==e.icon&&this.leafletElement.setIcon(t.icon),t.zIndexOffset!==e.zIndexOffset&&this.leafletElement.setZIndexOffset(t.zIndexOffset),t.opacity!==e.opacity&&this.leafletElement.setOpacity(t.opacity),t.draggable!==e.draggable&&(!0===t.draggable?this.leafletElement.dragging.enable():this.leafletElement.dragging.disable())}},{key:"render",value:function(){var e=this.props.children;return null==e||null==this.contextValue?null:r.a.createElement(g,{value:this.contextValue},e)}}]),t}(H)),$=n(41),X=n.n($),ee=["tile","shadow","overlay","map","marker","tooltip","popup"],te=/-*pane/gi,ne={position:"absolute",top:0,right:0,bottom:0,left:0},ae=(j(function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={name:void 0,context:void 0},n.setStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.props,t=e.style,a=e.className,r=n.getPane(n.state.name);r&&(a&&D(r,a),t&&Object(x.forEach)(t,function(e,t){r.style[t]=e}))},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.createPane(this.props)}},{key:"componentDidUpdate",value:function(e){if(this.state.name)if(this.props.name!==e.name)this.removePane(),this.createPane(this.props);else{if(e.className&&this.props.className!==e.className){var t=this.getPane(this.state.name);null!=t&&null!=e.className&&V(t,e.className)}this.setStyle(this.props)}}},{key:"componentWillUnmount",value:function(){this.removePane()}},{key:"createPane",value:function(e){var t=e.leaflet.map,n=e.name||"pane-".concat(Object(x.uniqueId)());if(null!=t&&null!=t.createPane){var a=function(e){return-1!==ee.indexOf(e.replace(te,""))}(n);if(null==(a||this.getPane(n)))t.createPane(n,this.getParentPane());else{var r=a?"You must use a unique name for a pane that is not a default leaflet pane (".concat(n,")"):"A pane with this name already exists. (".concat(n,")");X()(!1,r)}this.setState({name:n,context:Object(C.a)({},e.leaflet,{pane:n})},this.setStyle)}}},{key:"removePane",value:function(){var e=this.state.name;if(null!=e){var t=this.getPane(e);null!=t&&t.remove&&t.remove();var n=this.props.leaflet.map;null!=n&&null!=n._panes&&(n._panes=Object(x.omit)(n._panes,e),n._paneRenderers=Object(x.omit)(n._paneRenderers,e))}}},{key:"getParentPane",value:function(){return this.getPane(this.props.pane||this.props.leaflet.pane)}},{key:"getPane",value:function(e){if(null!=e&&null!=this.props.leaflet.map)return this.props.leaflet.map.getPane(e)}},{key:"render",value:function(){var e=this.state.context;return e?r.a.createElement(g,{value:e},r.a.createElement("div",{style:ne},this.props.children)):null}}]),t}(a.Component)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Polygon(e.positions,this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,t){t.positions!==e.positions&&this.leafletElement.setLatLngs(t.positions),this.setStyleIfChanged(e,t)}}]),t}(_)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Polyline(e.positions,this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,t){t.positions!==e.positions&&this.leafletElement.setLatLngs(t.positions),this.setStyleIfChanged(e,t)}}]),t}(_)),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onPopupOpen=function(e){e.popup===n.leafletElement&&n.onOpen()},n.onPopupClose=function(e){e.popup===n.leafletElement&&n.onClose()},n.onRender=function(){!1!==n.props.autoPan&&n.leafletElement.isOpen()&&(n.leafletElement._map&&n.leafletElement._map._panAnim&&(n.leafletElement._map._panAnim=void 0),n.leafletElement._adjustPan())},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"getOptions",value:function(e){return Object(C.a)({},Object(S.a)(Object(m.a)(t.prototype),"getOptions",this).call(this,e),{autoPan:!1})}},{key:"createLeafletElement",value:function(e){var t=this.getOptions(e);return t.autoPan=!1!==e.autoPan,new k.Popup(t,e.leaflet.popupContainer)}},{key:"updateLeafletElement",value:function(e,t){t.position!==e.position&&this.leafletElement.setLatLng(t.position)}},{key:"componentDidMount",value:function(){var e=this.props.position,t=this.props.leaflet,n=t.map,a=t.popupContainer,r=this.leafletElement;null!=n&&n.on({popupopen:this.onPopupOpen,popupclose:this.onPopupClose}),a?a.bindPopup(r):(e&&r.setLatLng(e),r.openOn(n))}},{key:"componentWillUnmount",value:function(){var e=this.props.leaflet.map;null!=e&&(e.off({popupopen:this.onPopupOpen,popupclose:this.onPopupClose}),e.removeLayer(this.leafletElement)),Object(S.a)(Object(m.a)(t.prototype),"componentWillUnmount",this).call(this)}}]),t}(R));ae.defaultProps={pane:"popupPane"};var re=j(ae),oe=(j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Rectangle(e.bounds,this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,t){t.bounds!==e.bounds&&this.leafletElement.setBounds(t.bounds),this.setStyleIfChanged(e,t)}}]),t}(_)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Control.Scale(e)}}]),t}(w)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.TileLayer(e.url,this.getOptions(e))}},{key:"updateLeafletElement",value:function(e,n){Object(S.a)(Object(m.a)(t.prototype),"updateLeafletElement",this).call(this,e,n),n.url!==e.url&&this.leafletElement.setUrl(n.url)}}]),t}(A))),le=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onTooltipOpen=function(e){e.tooltip===n.leafletElement&&n.onOpen()},n.onTooltipClose=function(e){e.tooltip===n.leafletElement&&n.onClose()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Tooltip(this.getOptions(e),e.leaflet.popupContainer)}},{key:"componentDidMount",value:function(){var e=this.props.leaflet.popupContainer;null!=e&&(e.on({tooltipopen:this.onTooltipOpen,tooltipclose:this.onTooltipClose}),e.bindTooltip(this.leafletElement))}},{key:"componentWillUnmount",value:function(){var e=this.props.leaflet.popupContainer;null!=e&&(e.off({tooltipopen:this.onTooltipOpen,tooltipclose:this.onTooltipClose}),null!=e._map&&e.unbindTooltip(this.leafletElement))}}]),t}(R);le.defaultProps={pane:"tooltipPane"};j(le),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=e.url,n=Object(L.a)(e,["url"]);return new k.TileLayer.WMS(t,this.getOptions(n))}},{key:"updateLeafletElement",value:function(e,n){Object(S.a)(Object(m.a)(t.prototype),"updateLeafletElement",this).call(this,e,n);var a=e.url,r=(e.opacity,e.zIndex,Object(L.a)(e,["url","opacity","zIndex"])),o=n.url,l=(n.opacity,n.zIndex,Object(L.a)(n,["url","opacity","zIndex"]));o!==a&&this.leafletElement.setUrl(o),Object(x.isEqual)(l,r)||this.leafletElement.setParams(l)}},{key:"getOptions",value:function(e){var n=Object(S.a)(Object(m.a)(t.prototype),"getOptions",this).call(this,e);return Object.keys(n).reduce(function(e,t){return T.test(t)||(e[t]=n[t]),e},{})}}]),t}(A)),j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){return new k.Control.Zoom(e)}}]),t}(w));var se=n(78),ie=j(function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"createLeafletElement",value:function(e){var t=e.url,n=e.color,a=(Object(L.a)(e,["url","color"]),{url:t,style:function(){return{color:n,weight:1}},useCors:!0}),r=new se.featureLayer(a);return r.on("click",function(e){console.log("feature layer click event: ",e)}),r.on("popupopen",function(e){console.log("popupopen!",e.layer.feature.properties)}),r.on("loading",function(e){console.log("loading feature layer!",e)}),r.on("load",function(e){console.log("loaded all queried feature layers event:",e)}),r.metadata(function(e,t){}),r.bindPopup(function(e){var t="";for(var n in e.feature.properties)e.feature.properties.hasOwnProperty(n)&&(-1===n.indexOf(".")?t+=n+" {"+n+"} <br />":n=n.replace(".","_"));return k.Util.template(t,e.feature.properties)}),r}},{key:"updateLeafletElement",value:function(e,n){Object(S.a)(Object(m.a)(t.prototype),"updateLeafletElement",this).call(this,e,n);var a=e.url,r=(e.opacity,e.zIndex,Object(L.a)(e,["url","opacity","zIndex"])),o=n.url,l=(n.opacity,n.zIndex,Object(L.a)(n,["url","opacity","zIndex"]));o!==a&&this.leafletElement.setUrl(o),Object(x.isEqual)(l,r)||this.leafletElement.setParams(l)}},{key:"getOptions",value:function(e){var n=Object(S.a)(Object(m.a)(t.prototype),"getOptions",this).call(this,e);return Object.keys(n).reduce(function(e,t){return T.test(t)||(e[t]=n[t]),e},{})}}]),t}(H)),ce=function(e){var t=e.content,n=e.position;return r.a.createElement(Y,{position:n},r.a.createElement(re,null,t))},ue=function(e){var t=e.markers.map(function(e){var t=e.key,n=Object(L.a)(e,["key"]);return r.a.createElement(ce,Object.assign({key:t},n))});return r.a.createElement(a.Fragment,null,t)},pe=(a.Component,"MAP"),he="HOTSPOTFORM",me="HOTSPOT",fe="LOGINFORM",de="REGISTERFORM",be={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"},Oe={newCoordinates:[],newLng:0,newLat:0,hotspot:null,showing:pe,previousView:pe,isUserLoggedIn:!1},ve=function(e){return function(t){t({type:"SET_USERLOGGEDIN",loggedIn:e})}},ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HOTSPOT_FORM":return Object(C.a)({},e,{newCoordinates:t.newCoordinates,showing:he});case"SHOW_MAP":return Object(C.a)({},e,{showing:pe});case"SHOW_PREVIOUS":return Object(C.a)({},e,{showing:e.previousView,previousView:pe});case"SHOW_HOTSPOT":return Object(C.a)({},e,{showing:me});case"HIDE_HOTSPOT":return Object(C.a)({},e,{showing:pe});case"SHOW_LOGINFORM":return Object(C.a)({},e,{previousView:e.showing,showing:fe});case"SHOW_REGISTERFORM":return Object(C.a)({},e,{previousView:e.showing,showing:de});case"SET_USERLOGGEDIN":return Object(C.a)({},e,{isUserLoggedIn:t.loggedIn});default:return e}},Ee=n(45),ge=n.n(Ee),je="/api/hotspots",ke={getAll:function(){var e=Object(c.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.get(je);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getHotspotsByCoordinates:function(){var e=Object(c.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.get("".concat(je,"/@").concat(t,",").concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),getHotspot:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.get("".concat(je,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.post(je,t,{withCredentials:!0});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},we={create:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.post("/api/comments",t,{withCredentials:!0});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Le={hotspots:[],currentHotspot:null,newHotspot:null,error:null},Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_HOTSPOTS_SUCCESS":return{hotspots:t.hotspots,error:null};case"GET_HOTSPOTS_FAIL":return Object(C.a)({},e,{error:t.error});case"SET_CURRENT_HOTSPOT":return Object(C.a)({},e,{currentHotspot:e.hotspots.find(function(e){return e.id===t.id}),error:null});case"ADD_HOTSPOT_SUCCESS":return Object(C.a)({},e,{hotspots:e.hotspots.concat(t.hotspot),newHotspot:t.hotspot,error:null});case"ADD_HOTSPOT_FAIL":return Object(C.a)({},e,{error:t.error});case"ADD_COMMENT_SUCCESS":var n=Object(C.a)({},e.hotspots.find(function(e){return e.id===t.comment.inHotspot.id}));return n.comments=n.comments.concat(t.comment),Object(C.a)({},e,{hotspots:e.hotspots.map(function(e){return e.id===n.id?n:e}),currentHotspot:n,error:null});case"ADD_COMMENT_FAIL":return Object(C.a)({},e,{error:t.error});default:return e}},Se=(G.BaseLayer,G.Overlay,function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={lat:68.7512,lng:25.6189,zoom:7},n.handleMapClick=function(e){console.log("coordinates2: ",e),n.props.isUserLoggedIn&&n.props.showHotspotForm(e)},n.handleHotspotClick=function(e){console.log(e.layer.feature.properties.id),n.props.setCurrentHotspot(e.layer.feature.properties.id),n.props.showHotspot()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(Q,{center:[this.state.lat,this.state.lng],zoom:this.state.zoom,handleMapClick:this.handleMapClick,handleHotspotClick:this.handleHotspotClick,hotspots:this.props.hotspots},r.a.createElement(G,{position:"topright"},r.a.createElement(G.BaseLayer,{name:"Peruskartta"},r.a.createElement(oe,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://tiles.kartat.kapsi.fi/peruskartta/{z}/{x}/{y}.png"})),r.a.createElement(G.BaseLayer,{name:"OpenStreetMap",checked:!0},r.a.createElement(oe,{url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label lightsteelblue'>kaivospiirihakemukset</span>"},r.a.createElement(ie,{name:"kaivospiirihakemukset",color:"lightsteelblue",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/0?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label steelblue'>kaivospiirit</span>"},r.a.createElement(ie,{color:"steelblue",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/1?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label darkblue'>kaivospiirit karenssissa</span>"},r.a.createElement(ie,{name:"kaivospiirit_karenssissa",color:"darkblue",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/2?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label burlywood'>kaivoslupahakemukset</span>"},r.a.createElement(ie,{name:"kaivoslupahakemukset",color:"burlywood",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/3?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label sandybrown'>kaivosalueet voimassa</span>"},r.a.createElement(ie,{name:"kaivosalueet_voimassa",color:"sandybrown",url:"http://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/4?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label green'>valtaushakemukset</span>"},r.a.createElement(ie,{name:"valtaushakemukset",color:"green",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/5?f=pjson"})),r.a.createElement(G.Overlay,{name:"<span class='layers-control-label forestgreen'>valtaukset</span>"},r.a.createElement(ie,{name:"valtaukset",color:"forestgreen",url:"http://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/6?f=pjson"})),r.a.createElement(G.Overlay,{name:"valtaukset karenssissa"},r.a.createElement(ie,{name:"valtaukset_karenssissa",color:"darkgreen",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/7?f=pjson"})),r.a.createElement(G.Overlay,{name:"malminetsintalupahakemukset",color:"lightpink"},r.a.createElement(ie,{name:"malminetsintalupahakemukset",color:"chocolate",url:"http://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/8?f=pjson"})),r.a.createElement(G.Overlay,{name:"malminetsintaalueet",color:"lightcoral"},r.a.createElement(ie,{name:"malminetsintaalueet",color:"saddlebrown",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/9?f=pjson"})),r.a.createElement(G.Overlay,{name:"malminetsintaluvat karenssissa"},r.a.createElement(ie,{name:"malminetsintaluvat_karenssissa",color:"sienna",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/10?f=pjson"})),r.a.createElement(G.Overlay,{name:"varausilmoitushakemukset"},r.a.createElement(ie,{name:"varausilmoitushakemukset",color:"darkviolet",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/11?f=pjson"})),r.a.createElement(G.Overlay,{name:"varausilmoitukset karenssissa"},r.a.createElement(ie,{name:"varausilmoitukset_karenssissa",color:"deeppink",url:"http://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/12?f=pjson"})),r.a.createElement(G.Overlay,{name:"varausilmoitukset"},r.a.createElement(ie,{name:"varausilmoitukset",color:"firebrick",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/13?f=pjson"})),r.a.createElement(G.Overlay,{name:"kullanhuuhdontaluvat"},r.a.createElement(ie,{name:"kullanhuuhdontaluvat",color:"gold",url:"http://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/14?f=pjson"})),r.a.createElement(G.Overlay,{name:"kullanhuuhdontalupahakemukset"},r.a.createElement(ie,{name:"kullanhuuhdontalupahakemukset",color:"darkgoldenrod",url:"https://gtkdata.gtk.fi/arcgis/rest/services/Tukes/TukesWMS/MapServer/15?f=pjson"}))))}}]),t}(a.Component)),xe={showHotspotForm:function(e){return function(t){e.latlng&&(e=[e.latlng.lng,e.latlng.lat]),t({type:"SHOW_HOTSPOT_FORM",newCoordinates:e})}},showHotspot:function(e){return function(e){e({type:"SHOW_HOTSPOT"})}},setCurrentHotspot:function(e){return function(t){t({type:"SET_CURRENT_HOTSPOT",id:e})}}},Te=Object(d.b)(function(e){return{hotspots:e.map.hotspots,isUserLoggedIn:e.view.isUserLoggedIn}},xe)(Se),Pe=(n(289),function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"MapContainer"},r.a.createElement(Te,null))}}]),t}(a.Component)),Me=n(471),He=n(468),Ie=n(201),_e=n(470),Ue=n(462),De={login:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.post("/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(c.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.post("/logout",{withCredentials:!0});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),register:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.a.post("/register",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Ve=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).logout=Object(c.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De.logout();case 2:n.props.setUserLoggedIn(!1);case 3:case"end":return e.stop()}},e,this)})),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(_e.a,{attached:"top",tabular:!0},r.a.createElement(Ue.a,null,r.a.createElement(_e.a.Item,null,"Luontovahdit"),r.a.createElement(_e.a.Menu,{position:"right"},e.props.isUserLoggedIn?r.a.createElement(He.a,{item:!0,icon:"bars",direction:"left"},r.a.createElement(He.a.Menu,null,r.a.createElement(He.a.Item,{onClick:e.logout},"Kirjaudu ulos",r.a.createElement(Ie.a,{style:{paddingLeft:"5px"},name:"log out"})))):r.a.createElement(_e.a.Item,{onClick:e.props.showLoginForm},r.a.createElement(Ie.a,{name:"sign in"})))))}}]),t}(r.a.Component),We={showLoginForm:function(){return function(e){e({type:"SHOW_LOGINFORM"})}},setUserLoggedIn:ve},Re=Object(Me.a)(Object(d.b)(function(e){return{isUserLoggedIn:e.view.isUserLoggedIn}},We)(Ve)),Ae=n(467),Fe=n(465),Ne=n(463),ze=n(469),Be={hotspots:[{type:"Feature",properties:{id:"5c1e0b21ee7a321eb40f3e12",icon:"star"},geometry:{type:"Point",coordinates:[24.8297076,60.3190656]}},{type:"Feature",properties:{id:"5c1e2ecbc969793cecad491a",icon:"star"},geometry:{type:"Point",coordinates:[25,60.2]}}]},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_HOTSPOTS":return{hotspots:t.hotspots};case"ADD_HOTSPOT":return{hotspots:e.hotspots.concat(t.hotspot)};default:return e}},Ge=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).close=function(){return n.props.hideHotspotForm()},n.addHotspot=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(t.target.title.value.length>0&&t.target.description.value.length>0)){e.next=10;break}return a={title:t.target.title.value,description:t.target.description.value,location:{type:"Point",coordinates:n.props.coordinates}},console.log("coordinates: ",n.props.coordinates),console.log("new hs?: ",a),t.target.title.value="",t.target.description.value="",e.next=9,n.props.addHotspot(a);case 9:n.props.error?(console.log("Error adding hotspot..."),console.log(n.props.error)):(console.log("Added hotspot!"),console.log(n.props.newHotspot),n.props.addHotspotToMap(n.props.newHotspot),n.props.hideHotspotForm());case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return console.log("open "+this.props.open),r.a.createElement("div",null,r.a.createElement(Ae.a,{open:this.props.open,closeOnDimmerClick:!1,onClose:this.close,closeIcon:!0},r.a.createElement(Ae.a.Header,null,"Lis\xe4\xe4 kohde"),r.a.createElement(Ae.a.Content,null,r.a.createElement(Fe.a,{onSubmit:this.addHotspot},r.a.createElement("div",null,"Kohteen nimi:",r.a.createElement(Fe.a.Input,{type:"text",name:"title"})),r.a.createElement("div",null,"Havainto:",r.a.createElement(Ne.a,{name:"description",style:{minHeight:100}})),r.a.createElement(ze.a,{type:"submit"},"Lis\xe4\xe4")))))}}]),t}(a.Component),Je={hideHotspotForm:function(){return function(e){e({type:"SHOW_MAP"})}},addHotspot:function(e){return function(){var t=Object(c.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ke.create(e);case 3:a=t.sent,n({type:"ADD_HOTSPOT_SUCCESS",hotspot:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n({type:"ADD_HOTSPOT_FAIL",error:"Kohdetta ei voitu lis\xe4t\xe4! "+t.t0});case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},addHotspotToMap:function(e){return function(t){var n={type:"Feature",properties:{id:e.id,icon:"star"},geometry:{type:"Point",coordinates:e.location.coordinates}};console.log(n),console.log(e.location),t({type:"ADD_HOTSPOT",hotspot:n})}}},Ke=Object(d.b)(function(e){return{open:e.view.showing===he,coordinates:e.view.newCoordinates,newHotspot:e.hotspot.newHotspot,error:e.hotspot.error}},Je)(Ge),qe=n(200),Qe=n(464),Ye=n(472),$e=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return console.log(this.props),r.a.createElement("div",null,this.props.comments.map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(Ye.a,null,new Date(e.createdAt).toLocaleDateString("fi-FI",be)," lis\xe4nnyt ",e.addedBy.name,r.a.createElement(Qe.a,{hidden:!0}),r.a.createElement("p",null,e.content),r.a.createElement(Qe.a,{hidden:!0}),r.a.createElement(ze.a,{as:"div",labelPosition:"right"},r.a.createElement(ze.a,{compact:!0,basic:!0,color:"green"},r.a.createElement(Ie.a,{name:"thumbs up"})),r.a.createElement(qe.a,{basic:!0,pointing:"left"},e.upVotes)),r.a.createElement(ze.a,{as:"div",labelPosition:"right"},r.a.createElement(ze.a,{compact:!0,basic:!0,color:"orange"},r.a.createElement(Ie.a,{name:"thumbs down"})),r.a.createElement(qe.a,{as:"a",basic:!0,pointing:"left"},e.downVotes)),r.a.createElement(ze.a,{compact:!0,basic:!0,color:"red"},r.a.createElement(Ie.a,{name:"flag"}))),r.a.createElement(Qe.a,{hidden:!0}))}))}}]),t}(r.a.Component),Xe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return r.a.createElement(Ye.a,null,r.a.createElement("div",{style:e},r.a.createElement(ze.a,{onClick:this.toggleVisibility},this.props.buttonLabel)),r.a.createElement("div",{style:t},r.a.createElement(ze.a,{basic:!0,onClick:this.toggleVisibility},"Peruuta"),r.a.createElement(Qe.a,{hidden:!0}),this.props.children))}}]),t}(r.a.Component),et=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).addComment=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(t.target.comment.value.length>0)){e.next=7;break}return a={content:t.target.comment.value,inHotspot:n.props.hotspotId},t.target.comment.value="",e.next=6,n.props.addComment(a);case 6:n.props.error?(console.log("Error adding comment..."),console.log(n.props.error)):console.log("Added hotspot!");case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(Fe.a,{onSubmit:this.addComment},r.a.createElement("div",null,r.a.createElement(Ne.a,{name:"comment",style:{minHeight:100}})),r.a.createElement(ze.a,{type:"submit"},"Lis\xe4\xe4"))}}]),t}(a.Component),tt={addComment:function(e){return function(){var t=Object(c.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,we.create(e);case 3:a=t.sent,n({type:"ADD_COMMENT_SUCCESS",comment:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n({type:"ADD_COMMENT_FAIL",error:"Kommentia ei voitu lis\xe4t\xe4! "+t.t0});case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()}},nt=Object(d.b)(function(e){return{error:e.hotspot.error}},tt)(et),at=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).close=function(){return n.props.hideHotspot()},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;if(this.props.hotspot){var t=this.props.hotspot;return r.a.createElement("div",null,r.a.createElement(Ae.a,{open:this.props.open,closeOnDimmerClick:!1,onClose:this.close,closeIcon:!0},r.a.createElement(Ae.a.Header,null,t.title),r.a.createElement(Ae.a.Content,null,r.a.createElement(ze.a,{as:"div",labelPosition:"right"},r.a.createElement(ze.a,{basic:!0,color:"green"},r.a.createElement(Ie.a,{name:"thumbs up"})),r.a.createElement(qe.a,{as:"a",basic:!0,pointing:"left"},t.upVotes)),r.a.createElement(ze.a,{as:"div",labelPosition:"right"},r.a.createElement(ze.a,{basic:!0,color:"orange"},r.a.createElement(Ie.a,{name:"thumbs down"})),r.a.createElement(qe.a,{as:"a",basic:!0,pointing:"left"},t.downVotes)),r.a.createElement(ze.a,{basic:!0,color:"red"},r.a.createElement(Ie.a,{name:"flag"})),"lis\xe4nnyt ",t.addedBy.name,r.a.createElement(Qe.a,{hidden:!0}),t.description,r.a.createElement(Qe.a,{hidden:!0}),e.props.isUserLoggedIn?r.a.createElement(Xe,{buttonLabel:"Kommentoi"},r.a.createElement(nt,{hotspotId:t.id})):null,r.a.createElement($e,{comments:t.comments}))))}return r.a.createElement("div",null,r.a.createElement(Ae.a,{open:this.props.open,closeOnDimmerClick:!1,onClose:this.close,closeIcon:!0},r.a.createElement(Ae.a.Header,null,"Kohdetta ei l\xf6ytynyt!"),r.a.createElement(Ae.a.Content,null,r.a.createElement("p",null,"Jotain meni pieleen."))))}}]),t}(a.Component),rt={hideHotspot:function(){return function(e){e({type:"SHOW_MAP"})}}},ot=Object(d.b)(function(e){return{open:e.view.showing===me,hotspot:e.hotspot.currentHotspot,isUserLoggedIn:e.view.isUserLoggedIn}},rt)(at),lt=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).open=function(){n.props.history.push("/login")},n.close=function(){n.props.hideLoginForm(),n.props.history.push("/")},n.login=function(){var e=Object(c.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(t.target.username.value.length>0&&t.target.password.value.length>0)){e.next=12;break}return e.prev=2,e.next=5,De.login({username:t.target.username.value,password:t.target.password.value});case 5:n.props.setUserLoggedIn(!0),n.props.hideLoginForm(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ae.a,{open:this.props.open,closeOnDimmerClick:!1,onOpen:this.open,onClose:this.close,closeIcon:!0},r.a.createElement(Ae.a.Header,null,"Tervetuloa!"),r.a.createElement(Ae.a.Content,null,r.a.createElement(Fe.a,{onSubmit:this.login},r.a.createElement("div",null,"K\xe4ytt\xe4j\xe4tunnus:",r.a.createElement(Fe.a.Input,{type:"text",name:"username"})),r.a.createElement("div",null,"Salasana:",r.a.createElement(Fe.a.Input,{type:"password",name:"password"})),r.a.createElement(ze.a,{type:"submit",icon:!0,labelPosition:"right"},"Kirjaudu sis\xe4\xe4n",r.a.createElement(Ie.a,{name:"sign in"})),r.a.createElement(ze.a,{type:"button",onClick:this.props.showRegisterForm},"Rekister\xf6idy?")))))}}]),t}(a.Component),st={hideLoginForm:function(){return function(e){e({type:"SHOW_PREVIOUS"})}},setUserLoggedIn:ve,showRegisterForm:function(){return function(e){e({type:"SHOW_REGISTERFORM"})}}},it=Object(Me.a)(Object(d.b)(function(e){return{open:e.view.showing===fe}},st)(lt)),ct=n(107),ut=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(m.a)(t).call(this,e))).close=function(){return n.props.hideRegisterForm()},n.register=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n.setState({usernameError:!1,passwordError:!1,displaynameError:!1,emailError:!1}),!(n.state.username.length<6)){e.next=5;break}return e.next=5,n.setState({usernameError:!0});case 5:if(!(n.state.password.length<8||n.state.password!==n.state.passwordConf)){e.next=8;break}return e.next=8,n.setState({passwordError:!0});case 8:if(!(n.state.displayname.length<6)){e.next=11;break}return e.next=11,n.setState({displaynameError:!0});case 11:if(!(n.state.email.length<6)){e.next=14;break}return e.next=14,n.setState({emailError:!0});case 14:if(!(n.state.usernameError||n.state.passwordError||n.state.displaynameError||n.state.emailError)){e.next=18;break}return e.abrupt("return");case 18:return a={username:n.state.username,password:n.state.password,displayname:n.state.displayname,email:n.state.email},e.prev=19,e.next=22,De.register(a);case 22:n.props.hideRegisterForm(),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(19),console.log("Virhe rekister\xf6inniss\xe4..."),console.log(e.t0);case 29:case"end":return e.stop()}},e,this,[[19,25]])}));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(e){n.setState(Object(ct.a)({},e.target.name,e.target.value))},n.state={username:"",password:"",passwordConf:"",displayname:"",email:"",usernameError:!1,passwordError:!1,displaynameError:!1,emailError:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return console.log("open "+this.props.open),r.a.createElement("div",null,r.a.createElement(Ae.a,{open:this.props.open,closeOnDimmerClick:!1,onClose:this.close,closeIcon:!0},r.a.createElement(Ae.a.Header,null,"Rekister\xf6idy k\xe4ytt\xe4j\xe4ksi"),r.a.createElement(Ae.a.Content,null,r.a.createElement(Fe.a,{onSubmit:this.register},r.a.createElement("div",null,"K\xe4ytt\xe4j\xe4tunnus:",r.a.createElement(Fe.a.Input,{type:"text",name:"username",error:this.state.usernameError,onChange:this.handleChange})),r.a.createElement("div",null,"Salasana:",r.a.createElement(Fe.a.Input,{type:"password",name:"password",error:this.state.passwordError,onChange:this.handleChange})),r.a.createElement("div",null,"Salasana uudelleen:",r.a.createElement(Fe.a.Input,{type:"password",name:"passwordConf",error:this.state.passwordError,onChange:this.handleChange})),r.a.createElement("div",null,"Nimimerkki:",r.a.createElement(Fe.a.Input,{type:"text",name:"displayname",error:this.state.displaynameError,onChange:this.handleChange})),r.a.createElement("div",null,"S\xe4hk\xf6postiosoite:",r.a.createElement(Fe.a.Input,{type:"text",name:"email",error:this.state.emailError,onChange:this.handleChange})),r.a.createElement(ze.a,{type:"submit"},"Rekister\xf6idy")))))}}]),t}(a.Component),pt={hideRegisterForm:function(){return function(e){e({type:"SHOW_PREVIOUS"})}}},ht=Object(d.b)(function(e){return{open:e.view.showing===de}},pt)(ut);n(450);var mt=function(e){function t(){return Object(u.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Hello"),e.next=3,this.props.initialiseHotspots();case 3:this.props.hotspots&&(console.log(this.props.hotspots),this.props.setHotspotsOnMap(this.props.hotspots));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(Re,null)),r.a.createElement("div",null,r.a.createElement(Pe,null)),r.a.createElement(Ke,null),r.a.createElement(ot,null),r.a.createElement(it,null),r.a.createElement(ht,null))}}]),t}(r.a.Component),ft={initialiseHotspots:function(){return function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ke.getAll();case 3:n=e.sent,console.log("Fetched hotspots: ",n),t({type:"GET_HOTSPOTS_SUCCESS",hotspots:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t({type:"GET_HOTSPOTS_FAIL",error:"Virhe kohteiden haussa! "+e.t0});case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()},setHotspotsOnMap:function(e){return function(t){var n=e.map(function(e){return{type:"Feature",properties:{id:e.id,icon:"star"},geometry:{type:"Point",coordinates:e.location.coordinates}}});console.log(n),t({type:"SET_HOTSPOTS",hotspots:n})}}},dt=Object(d.b)(function(e){return{hotspots:e.hotspot.hotspots}},ft)(mt),bt=n(65),Ot=n(248),vt=n(249),yt=Object(bt.combineReducers)({map:Ze,view:ye,hotspot:Ce}),Et=Object(bt.createStore)(yt,Object(vt.composeWithDevTools)(Object(bt.applyMiddleware)(Ot.a))),gt=n(466),jt=function(){l.a.render(r.a.createElement(d.a,{store:Et},r.a.createElement(gt.a,null,r.a.createElement(dt,null))),document.getElementById("root"))};jt(),Et.subscribe(jt)}},[[259,2,1]]]);
//# sourceMappingURL=main.8d0d8a52.chunk.js.map